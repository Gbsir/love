<!DOCTYPE html>
<html lang="zh">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>张小硕羊汤店 - 扫码点餐</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet"/>
  <style>
    body { background: #f8f9fa; padding: 20px; }
    .dish { background: white; border-radius: 10px; padding: 15px; margin-bottom: 15px; box-shadow: 0 2px 5px rgba(0,0,0,0.1); }
    .cart-item { display: flex; justify-content: space-between; padding: 5px 0; }
    .btn-dark { background: #333; }
  </style>
</head>
<body>

<div class="container">
  <h1 class="text-center text-primary mb-4">张小硕羊汤店</h1>
  <p class="text-center text-muted">扫码点餐 · 快速上菜</p>

  <!-- 桌号选择 -->
  <div class="mb-3">
    <label>请选择桌号：</label>
    <select id="tableSelect" class="form-select">
      <option>请选择</option>
      <option>A1</option>
      <option>A2</option>
      <option>A3</option>
      <option>A4</option>
      <option>A5</option>
      <option>A6</option>
      <option>A7</option>
    </select>
  </div>

  <!-- 菜单 -->
  <h3>菜单</h3>
  <div id="menu"></div>

  <!-- 购物车 -->
  <div class="mt-4 p-3 bg-white rounded shadow" id="cartSection" style="display:none;">
    <h4>购物车</h4>
    <div id="cartItems"></div>
    <div class="mt-3">
      <strong>总计：<span id="totalPrice">0</span> 元</strong>
    </div>
    <button onclick="submitOrder()" class="btn btn-success mt-2">提交订单</button>
  </div>

  <div class="text-center mt-5 text-muted">
    <small>张小硕羊汤店 · 用心熬好每一碗汤</small>
  </div>
</div>

<script>
  // 菜单数据
  const menu = [
    { id: 1, name: "宫保鸡丁", price: 32 },
    { id: 2, name: "鱼香肉丝", price: 30 },
    { id: 3, name: "酸辣汤", price: 12 },
    { id: 4, name: "米饭", price: 2 },
    { id: 5, name: "羊汤", price: 15 }
  ];

  let cart = [];

  // 渲染菜单
  function renderMenu() {
    const menuEl = document.getElementById("menu");
    menu.forEach(item => {
      const dish = document.createElement("div");
      dish.className = "dish";
      dish.innerHTML = `
        <div class="d-flex justify-content-between align-items-center">
          <div>
            <h5>${item.name}</h5>
            <p class="text-danger">¥${item.price}</p>
          </div>
          <button class="btn btn-dark btn-sm" onclick="addToCart(${item.id})">+</button>
        </div>
      `;
      menuEl.appendChild(dish);
    });
  }

  // 加入购物车
  function addToCart(id) {
    const table = document.getElementById("tableSelect").value;
    if (!table || table === "请选择") {
      alert("请先选择桌号！");
      return;
    }
    const item = menu.find(m => m.id === id);
    const exist = cart.find(c => c.id === id);
    if (exist) {
      exist.qty++;
    } else {
      cart.push({ ...item, qty: 1 });
    }
    updateCart();
  }

  // 更新购物车显示
  function updateCart() {
    const cartSection = document.getElementById("cartSection");
    const cartItems = document.getElementById("cartItems");
    const totalPrice = document.getElementById("totalPrice");
    
    cartSection.style.display = "block";
    cartItems.innerHTML = "";
    
    let total = 0;
    cart.forEach(item => {
      const el = document.createElement("div");
      el.className = "cart-item";
      el.innerHTML = `${item.name} ×${item.qty} <span>¥${item.price * item.qty}</span>`;
      cartItems.appendChild(el);
      total += item.price * item.qty;
    });
    
    totalPrice.textContent = total;
  }

  // 提交订单（下一步我们会连接 Firebase）
  function submitOrder() {
    const table = document.getElementById("tableSelect").value;
    if (cart.length === 0) {
      alert("购物车为空！");
      return;
    }
    if (!table) {
      alert("请先选择桌号！");
      return;
    }

    // 模拟提交（稍后替换为 Firebase）
    const order = {
      table: table,
      items: cart,
      total: cart.reduce((sum, item) => sum + item.price * item.qty, 0),
      time: new Date().toLocaleString(),
      status: "新订单"
    };

    // 临时弹窗显示（真实环境会发送到数据库）
    alert(`订单提交成功！\n桌号：${table}\n总计：¥${order.total}\n请等待上菜~`);

    console.log("订单数据：", order);
    // 这里我们将把 order 发送到云端数据库（Firebase）

    // 清空购物车
    cart = [];
    updateCart();
    document.getElementById("tableSelect").value = "请选择";
  }

  // 页面加载完成
  window.onload = function() {
    renderMenu();
  };
</script>

</body>
</html>
